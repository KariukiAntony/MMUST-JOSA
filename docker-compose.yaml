version: "3.9"
services:
  josa_app:
    image: josa_image
    container_name: josa_container
    build: .
    ports: [5000:5000]
    volumes:
      - ./:/Josa/

    env_file:
      - ./.env

    environment:
      - DATABASE_URI=postgresql://postgres:postgres@josa_db:5432/postgres
    
    depends_on: [josa_db]

  josa_db:
    image: postgres:12
    container_name: db
    ports: [5432:5432]

    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_HOST=postgres

    volumes:
      - postgres_data:/var/lib/postgresql/data #storing the data generated by this container

# storing data in named volumes outside the conatiner
volumes:
  postgres_data: {}
